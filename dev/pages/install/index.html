<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Installation · Susi</title><link rel="canonical" href="https://andreasdominik.github.io/Susi/dev/pages/install/index.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../../assets/logo.svg" alt="Susi logo"/></a><div class="docs-package-name"><span class="docs-autofit">Susi</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Installation</a><ul class="internal"><li><a class="tocitem" href="#*Speech-to-text*-and-*text-to-speech*-1"><span><em>Speech to text</em> and <em>text to speech</em></span></a></li><li><a class="tocitem" href="#Installation-with-the-installation-script-(Raspberry-Pi-only)-1"><span>Installation with the installation script (Raspberry Pi only)</span></a></li><li><a class="tocitem" href="#Manual-installation-1"><span>Manual installation</span></a></li><li><a class="tocitem" href="#Configure-Susi-1"><span>Configure Susi</span></a></li><li><a class="tocitem" href="#Configure-STT-and-TTS-services-1"><span>Configure STT and TTS services</span></a></li><li><a class="tocitem" href="#Start-Susi-service-1"><span>Start Susi service</span></a></li></ul></li><li><a class="tocitem" href="../configuration/">Configuration</a></li><li><a class="tocitem" href="../components/">Components</a></li><li><a class="tocitem" href="../nlu/">NLU</a></li><li><a class="tocitem" href="../payloads/">Payloads</a></li><li><a class="tocitem" href="../topics/">Topics</a></li><li><a class="tocitem" href="../tools/">Tools</a></li><li><a class="tocitem" href="../../LICENSE/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Installation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Installation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/andreasdominik/Susi/blob/master/docs/src/pages/install.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-installation-1"><a class="docs-heading-anchor" href="#Basic-installation-1">Basic installation</a><a class="docs-heading-anchor-permalink" href="#Basic-installation-1" title="Permalink"></a></h1><p>This tutorial shows a brief installation of Susi. More configuration and customisation is possible - please read the sections &quot;Configuration file susi.toml&quot; and &quot;Daemons&quot; for details about alternative configurations.</p><p>Susi may be installed on any linux/unix-like operating system.     Because Susi is build with a minimum of specific implementation major parts of its functionality are taken from existing projects. Therefore bunch of software must be installed before using Susi.</p><p>For Raspberry Pis an installation script is available, but manual installation is simple, and Susi can be installed on every device that have a bash available (because major parts of Susi are implemented as simple bash-scripts).</p><p>For both methods you must descide for TTS and STT services to be used. These must be installed and configured seperately:</p><h2 id="*Speech-to-text*-and-*text-to-speech*-1"><a class="docs-heading-anchor" href="#*Speech-to-text*-and-*text-to-speech*-1"><em>Speech to text</em> and <em>text to speech</em></a><a class="docs-heading-anchor-permalink" href="#*Speech-to-text*-and-*text-to-speech*-1" title="Permalink"></a></h2><p>Susi does not come with an own AI for STT and TTS and needs external services to transcribe audio to text as well as for speech synthesis. The modular design of Susi makes it easy to integrate any service. Currently 4 alternatives are implemented:</p><ul><li><strong>Google Cloud:</strong> best quality for both STT and TTS, but cloud-based not local, and not for free - expect cost in the range of 0.5-1$ per month.</li><li><strong>IBM Cloud:</strong> the free &quot;Light Plan&quot; will be sufficient for most cases. However, this is also not local.</li><li><strong>Mozilla Deep Speech</strong> can be installed locally and hence will preserve privacy. However the quality of STT is limited.</li><li><strong>Snips ASR</strong> can be used fot STT if a trained model is available (e.g. from an assistant downloaded from the Snps console).</li></ul><p>Please see in the section <em>Components</em> for more alternatives. Only <strong>one</strong> of the alternatives must be installed. STT and TTS services are selected by specifying the respective binary in the <code>[stt]</code> and <code>[tts]</code> sections of the configuration file.</p><p>Please refer to the section <em>Daemons and Comonents</em> for detailed installation and configuration instructions for the respective STT and TTS services.</p><h2 id="Installation-with-the-installation-script-(Raspberry-Pi-only)-1"><a class="docs-heading-anchor" href="#Installation-with-the-installation-script-(Raspberry-Pi-only)-1">Installation with the installation script (Raspberry Pi only)</a><a class="docs-heading-anchor-permalink" href="#Installation-with-the-installation-script-(Raspberry-Pi-only)-1" title="Permalink"></a></h2><p>In most cases the install script will do the installation. Just download the latest Susi release from GitHub unpack it to a temporary location and run <code>sudo ./install</code> or <code>sudo ./install satellite</code> to make a full or a sattelite installation.</p><p>After the script has completed STT and TTS must be configured (for details see below in section <em>Configure Susi</em>).</p><h2 id="Manual-installation-1"><a class="docs-heading-anchor" href="#Manual-installation-1">Manual installation</a><a class="docs-heading-anchor-permalink" href="#Manual-installation-1" title="Permalink"></a></h2><p>The tutorial assumes that all indivdual software is installed at <code>/opt/</code>. So the first step is to login as the user which will run the assistant later (such as <code>susi</code>), and create the directory <code>/opt/Susi</code>.</p><pre><code class="language-none">sudo mkdir /opt/Susi
chown susi /opt/Susi
chgrp susi /opt/Susi</code></pre><h3 id="Dependencies-1"><a class="docs-heading-anchor" href="#Dependencies-1">Dependencies</a><a class="docs-heading-anchor-permalink" href="#Dependencies-1" title="Permalink"></a></h3><h4 id="git-1"><a class="docs-heading-anchor" href="#git-1">git</a><a class="docs-heading-anchor-permalink" href="#git-1" title="Permalink"></a></h4><p>Most of the software must be obtained from git repos; therefore git must be installed first:</p><pre><code class="language-none">sudo apt-get install git-core curl coreutils</code></pre><h4 id="mosquitto,-jq-1"><a class="docs-heading-anchor" href="#mosquitto,-jq-1">mosquitto, jq</a><a class="docs-heading-anchor-permalink" href="#mosquitto,-jq-1" title="Permalink"></a></h4><p>mosquitto server and client are needed to publish and subscribe to MQTT messages. The package mosquitto provides the MQTT broker and is only necessary for the main installation and not for satellites. MQTT messages are sent as JSON strings. susi uses <code>jq</code> to parse JSON. In order to avoid sending binary files via MQTT, they are base64 encoded.</p><p>Be sure to disable the mosquitto-service! Susi will start mosquitto when it is needed.</p><p>The base64 utility is part of the coreutils:</p><pre><code class="language-none">sudo apt-get install mosquitto mosquitto-clients coreutils jq
sudo systemctl stop mosquitto.service
sudo systemctl disable mosquitto.service</code></pre><h4 id="Julia-1"><a class="docs-heading-anchor" href="#Julia-1">Julia</a><a class="docs-heading-anchor-permalink" href="#Julia-1" title="Permalink"></a></h4><p>some components of the system are written in the nice and fast programming laguage Julia. Install the current version from https://www.julialang.org (a good location is <code>/opt/Susi/Julia</code>) by downloading the version for your platform to <code>/opt/Susi/Julia</code>, unpacking and creating a link to <code>/usr/local/bin</code> to make it available (example for 64-bit linux version 1.3.1).</p><p>Some Julia packages are needed and can be installed right now:</p><pre><code class="language-none">mkdir /opt/Julia
cd /opt/Julia
cp ~/Downloads/julia-1.3.1-linux-x86_64.tar.gz .
tar xvzf julia-1.3.1-linux-x86_64.tar.gz

cd /usr/local/bin
sudo ln -s /opt/Julia/julia-1.3.1/bin/julia
julia -e &#39;using Pkg; Pkg.add([&quot;ArgParse&quot;, &quot;JSON&quot;, &quot;StatsBase&quot;]; Pkg.update()&#39;</code></pre><h4 id="sox-1"><a class="docs-heading-anchor" href="#sox-1">sox</a><a class="docs-heading-anchor-permalink" href="#sox-1" title="Permalink"></a></h4><p>sox is used for recording and playing sound. It must be installed on the main installation and on all satellites. In addition ffmpeg and and libsox-fmt-mp3 might be necessary in order to be able to play all types of audio files.</p><p>After installation sox can be tested with <code>rec firstaudio.wav</code> and <code>play firstaudio.wav</code>. Volume gain may be adapted with alsamixer or (x11) pavucontrol.</p><pre><code class="language-none">sudo apt-get install sox libsox-fmt-mp3
sudo apt-get install ffmpeg</code></pre><h4 id="Snowboy-1"><a class="docs-heading-anchor" href="#Snowboy-1">Snowboy</a><a class="docs-heading-anchor-permalink" href="#Snowboy-1" title="Permalink"></a></h4><p>the Snowboy hotword detector is used by default for hotword recognition. Snowboy is completely local and allows to create and train own hotwords via a web-interface.    </p><ul><li>download the binaries for the required platform from https://github.com/kitt-ai/snowboy.</li><li>unpack the tar ball to <code>/opt/Snowboy</code></li><li>install the dependencies for the required platform as described in https://github.com/kitt-ai/snowboy/README.md</li></ul><h5 id="Hotwords-1"><a class="docs-heading-anchor" href="#Hotwords-1">Hotwords</a><a class="docs-heading-anchor-permalink" href="#Hotwords-1" title="Permalink"></a></h5><p>After the installation the latest version of the default hotword (i.e. <em>Snowboy</em>) and individual hotwords can be created and downloaded into  the directory <code>/opt/Susi/Susi/src/Snowboy/resources</code>.</p><p>To improve hotword detection it is recommended to train the hotword with the voices of all speakers before downloading. Many hotwords are alredy trained and new hotwords can be created easily via the Snowboy website. It is always a good idea to improve training of a hotword with your own voice before downloading:</p><ul><li><strong>snowboy.umdl:</strong> https://snowboy.kitt.ai/hotword/5 (the best hotword, recommended for testing)</li><li><strong>smart_mirror.umdl:</strong> https://snowboy.kitt.ai/hotword/47</li><li><strong>computer.umdl:</strong> https://snowboy.kitt.ai/hotword/46</li><li><strong>susi.pmdl:</strong> https://snowboy.kitt.ai/hotword/7915 (however a hotword with only 2 syllables may show high false activation rate; better try something like &quot;hey Susi&quot;).</li></ul><p>Snowboy can be tested like described in the Snowboy docu.</p><pre><code class="language-none">mkdir /opt/Snowboy
cd /opt/Snowboy
#
# replace rpi-arm-raspbian-8.0-1.3.0.tar.bz2 with the precompiled
# binaries for the required platform:
cp ~/Downloads/rpi-arm-raspbian-8.0-1.3.0.tar.bz2 /opt/Snowboy
tar xvf rpi-arm-raspbian-8.0-1.3.0.tar.bz2
sudo apt-get install python-pyaudio python3-pyaudio sox</code></pre><h3 id="Get-and-install-Susi-1"><a class="docs-heading-anchor" href="#Get-and-install-Susi-1">Get and install Susi</a><a class="docs-heading-anchor-permalink" href="#Get-and-install-Susi-1" title="Permalink"></a></h3><ul><li>Clone Susi from the GitHub repo</li><li>make the installation directory available in the environment</li><li>integrate Snowboy</li><li>make links to the executables</li><li>install and activate systemd service to make susi available as service</li><li>install and edit the configuration file <code>/etc/susi.toml</code></li></ul><p>Before starting the service, the configuration must be adapted to the local installation (see next section for details).</p><pre><code class="language-none"># Susi:
cd /opt/Susi
mkdir /opt/Susi/ApplicationData
mkdir /opt/Susi/Skills
git clone git@github.com:andreasdominik/Susi.git

# add variable to environment:
grep &quot;^export SUSI_INSTALLATION=&quot; ~/.bashrc || echo &quot;export SUSI_INSTALLATION=/opt/Susi/Susi&quot; &gt;&gt; ~/.bashrc
source ~/.bashrc

# Snowboy:
# replace rpi-arm-raspbian-8.0-1.3.0.tar.bz2 with the precompiled
# binaries for the required platform:
cp /opt/Susi/Susi/src/Snowboy/bin/hotword_susi.py /opt/Snowboy/rpi-arm-raspbian-8.0-1.3.0/
cp /opt/Susi/Susi/src/Snowboy/bin/snowboydecoder_susi.py /opt/Snowboy/rpi-arm-raspbian-8.0-1.3.0/

# Susi service and execs:
cd /usr/local/bin/
sudo ln -s /opt/Susi/Susi/bin/susi.watch
sudo ln -s /opt/Susi/Susi/bin/susi
sudo ln -s /opt/Susi/Susi/bin/susi.say
sudo ln -s /opt/Susi/Susi/src/Service/susi.start
sudo ln -s /opt/Susi/Susi/src/Service/susi.stop

cd $SUSI_INSTALLATION
sudo cp /opt/Susi/Susi/src/Service/susi.service /etc/systemd/system/
sudo chmod 644 /etc/systemd/system/susi.service

# configuration:
sudo cp /opt/Susi/Susi/etc/susi.toml /etc/susi.toml</code></pre><h4 id="Duckling-1"><a class="docs-heading-anchor" href="#Duckling-1">Duckling</a><a class="docs-heading-anchor-permalink" href="#Duckling-1" title="Permalink"></a></h4><p>Duckling is used to parse transcribed voice input into time or numbers. For performance reasons Susi uses the Rust-port (done by the Snips people) of Duckling (so-called <em>Rustling</em>).</p><p>For 32-bit ARM and 64-bit x86 precompiled binaries are available. Just copy the correct binary to <code>/opt/Rustling/bin</code>.</p><p>Otherwise Rust and Rustling can be installes as follows:</p><pre><code class="language-none"># Rust:
mkdir -p /opt/Rustling
mkdir -p /opt/Rustling/bin
cd /opt/Rustling

curl --proto &#39;=https&#39; --tlsv1.2 -sSf https://sh.rustup.rs | sh

# Rustling:
cd /opt/Rustling
git clone https://github.com/snipsco/rustling-ontology.git

cp -r /opt/Susi/Susi/src/Duckling/Rustling/rustling-ontology/listener /opt/Rustling/rustling-ontology/
cp /opt/Susi/Susi/src/Duckling/Rustling/rustling-ontology/Cargo.toml /opt/Rustling/rustling-ontology/
cd /opt/Rustling/rustling-ontology/listener
cargo build --release
cp /opt/Rustling/rustling-ontology/target/release/rustling-listener opt/Rustling/bin/</code></pre><p>Depending on the hardware, the build process may need from some minutes up to several hours.</p><h2 id="Configure-Susi-1"><a class="docs-heading-anchor" href="#Configure-Susi-1">Configure Susi</a><a class="docs-heading-anchor-permalink" href="#Configure-Susi-1" title="Permalink"></a></h2><p>Susi is configured with the file <code>/etc/susi.toml</code>. Susi consists of several daemons that runs at the main system or on all satellites:</p><ul><li>hotword daemon: Hotword detection (all satellites)</li><li>record daemon: record commands (all satellites)</li><li>play daemon: play a audio file (all satellites)</li><li>STT daemon: transcribe recorded speech (audio) to text (only one)</li><li>TTS daemon: synthesise speech (audio) from text (only one)</li><li>NLU daemon: analyse a transcribed command and create an intent (only one)</li><li>session daemon. the session manager that defines pipelines of actions to be executed when a hotword or other trigger is detected (only one).</li><li>duckling server: the duckling webserver is used to extract time, numbers or ordinals from commands.</li></ul><p><code>susi.toml</code> is a standard toml file. All path definitions can be given as relative or absolute paths: if a path starts with an &quot;/&quot;, it is considered to be an absolute path, if not it is expanded relative to the Susi installation (default: &quot;/opt/Susi/Susi&quot;).</p><p>More information about all entries is given in the file.</p><h4 id="Standard-configuration-1"><a class="docs-heading-anchor" href="#Standard-configuration-1">Standard configuration</a><a class="docs-heading-anchor-permalink" href="#Standard-configuration-1" title="Permalink"></a></h4><p>Most parameters in the configuration file are by default set to resonable values and are self-explaining.</p><ul><li>specify a language code</li><li>select a name for the assistant</li><li>go through the file and double-check or adapt paths if necessary.</li></ul><h2 id="Configure-STT-and-TTS-services-1"><a class="docs-heading-anchor" href="#Configure-STT-and-TTS-services-1">Configure STT and TTS services</a><a class="docs-heading-anchor-permalink" href="#Configure-STT-and-TTS-services-1" title="Permalink"></a></h2><p>Services for speech-to-text and text-to-speech must be configured for the assistant. Easiest configuration and best quality are provided by Google&#39;s or IBM&#39;s services. Please read in the section <em>Components</em> for details how to configure them. Configuration of local services is described there, too.</p><h2 id="Start-Susi-service-1"><a class="docs-heading-anchor" href="#Start-Susi-service-1">Start Susi service</a><a class="docs-heading-anchor-permalink" href="#Start-Susi-service-1" title="Permalink"></a></h2><p>The last step is to enable the service it to make sure Susi is started at reboot:</p><pre><code class="language-none">sudo systemctl enable susi.service</code></pre><p>The service can be started manually with systemctl:</p><pre><code class="language-none">sudo systemctl start susi.service
sudo systemctl restart susi.service
sudo systemctl stop susi.service</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../configuration/">Configuration »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 20 March 2020 07:58">Friday 20 March 2020</span>. Using Julia version 1.2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
